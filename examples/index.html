<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>sane-router - Semantic HTML Example</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    header {
      border-bottom: 2px solid #eee;
      padding-bottom: 1rem;
      margin-bottom: 2rem;
    }

    h1 {
      color: #2563eb;
      margin-bottom: 0.5rem;
    }

    nav {
      margin-top: 1rem;
    }

    nav a {
      display: inline-block;
      padding: 0.5rem 1rem;
      margin-right: 0.5rem;
      text-decoration: none;
      color: #4b5563;
      border-radius: 0.375rem;
      transition: all 0.2s;
    }

    nav a:hover {
      background: #f3f4f6;
      color: #1f2937;
    }

    nav a.active {
      background: #2563eb;
      color: white;
    }

    main {
      min-height: 400px;
    }

    .page {
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-top: 1.5rem;
    }

    .product-card {
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 1.5rem;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .product-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .product-card a {
      color: #2563eb;
      text-decoration: none;
      font-weight: 600;
    }

    .product-card a:hover {
      text-decoration: underline;
    }

    .loading {
      display: inline-block;
      width: 2rem;
      height: 2rem;
      border: 3px solid #f3f4f6;
      border-top-color: #2563eb;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    footer {
      margin-top: 3rem;
      padding-top: 2rem;
      border-top: 2px solid #eee;
      color: #6b7280;
      font-size: 0.875rem;
    }

    code {
      background: #f3f4f6;
      padding: 0.125rem 0.375rem;
      border-radius: 0.25rem;
      font-size: 0.875rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>sane-router</h1>
    <p>Declarative, type-safe routing with semantic HTML</p>

    <nav>
      <a href="/">Home</a>
      <a href="/about">About</a>
      <a href="/products">Products</a>
      <a href="/contact">Contact</a>
    </nav>
  </header>

  <main id="app">
    <div class="loading"></div>
  </main>

  <footer>
    <p>Notice how all the links are just regular <code>&lt;a href&gt;</code> tags?</p>
    <p>sane-router automatically intercepts clicks and handles navigation.</p>
    <p>Try opening dev tools and watching the network tab - no full page reloads!</p>
  </footer>

  <script type="module">
    // This would normally be imported from npm
    // import { createRouter, route } from 'sane-router';

    // For this demo, we'll inline a minimal version
    class DemoRouter {
      constructor(routes) {
        this.routes = routes;
        this.listeners = new Set();
        this.setupListeners();
        this.navigate(window.location.pathname, { replace: true });
      }

      setupListeners() {
        window.addEventListener('popstate', () => {
          this.navigate(window.location.pathname, { replace: true });
        });

        document.addEventListener('click', (e) => {
          const link = e.target.closest('a[href]');
          if (!link) return;

          const href = link.getAttribute('href');
          if (href.startsWith('/') && !link.hasAttribute('data-external')) {
            e.preventDefault();
            this.navigate(href);
          }
        });
      }

      async navigate(path, options = {}) {
        if (!options.replace) {
          window.history.pushState({}, '', path);
        }

        // Update active links
        document.querySelectorAll('nav a').forEach(link => {
          const href = link.getAttribute('href');
          link.classList.toggle('active', href === path);
        });

        // Find matching route
        const route = this.routes.find(r => {
          if (r.path.includes(':')) {
            const regex = new RegExp('^' + r.path.replace(/:(\w+)/g, '([^/]+)') + '$');
            return regex.test(path);
          }
          return r.path === path;
        });

        const app = document.getElementById('app');

        if (!route) {
          app.innerHTML = `
            <div class="page">
              <h2>404 - Page Not Found</h2>
              <p>The page <code>${path}</code> doesn't exist.</p>
              <p><a href="/">Go home</a></p>
            </div>
          `;
          return;
        }

        // Call component
        await route.component();

        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }

    // Declarative route definitions
    const router = new DemoRouter([
      {
        path: '/',
        component: () => {
          document.getElementById('app').innerHTML = `
            <div class="page">
              <h2>Welcome to sane-router</h2>
              <p>This is a demonstration of declarative, type-safe routing with semantic HTML.</p>

              <h3 style="margin-top: 2rem;">Key Features:</h3>
              <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>✅ Declarative route configuration</li>
                <li>✅ Type-safe parameters (with TypeScript)</li>
                <li>✅ Works with standard &lt;a href&gt; links</li>
                <li>✅ Automatic link interception</li>
                <li>✅ Only ~4KB gzipped</li>
                <li>✅ Zero dependencies</li>
                <li>✅ Framework agnostic</li>
              </ul>

              <h3 style="margin-top: 2rem;">Try it out:</h3>
              <p>Click the links in the navigation above. Notice how:</p>
              <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Pages change instantly without full reload</li>
                <li>The URL updates in the address bar</li>
                <li>Browser back/forward buttons work</li>
                <li>Active link is highlighted</li>
                <li>Links are just regular HTML</li>
              </ul>
            </div>
          `;
        }
      },

      {
        path: '/about',
        component: () => {
          document.getElementById('app').innerHTML = `
            <div class="page">
              <h2>About sane-router</h2>
              <p>Modern JavaScript frameworks are bloated. You don't need 26KB of routing code.</p>

              <h3 style="margin-top: 2rem;">Why "sane"?</h3>
              <p>Because routing shouldn't be complicated:</p>
              <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Define your routes as data</li>
                <li>Use standard HTML links</li>
                <li>Let the router handle everything else</li>
              </ul>

              <h3 style="margin-top: 2rem;">Performance First</h3>
              <p>sane-router is designed with performance as a first-class concern:</p>
              <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Routes compiled once at initialization</li>
                <li>URLPattern API for native-speed matching</li>
                <li>Lazy loading by default</li>
                <li>Parallel data loading</li>
                <li>Memoized route matching</li>
              </ul>
            </div>
          `;
        }
      },

      {
        path: '/products',
        component: async () => {
          const app = document.getElementById('app');
          app.innerHTML = `
            <div class="page">
              <h2>Products</h2>
              <div class="loading" style="margin-top: 2rem;"></div>
            </div>
          `;

          // Simulate API call
          await new Promise(resolve => setTimeout(resolve, 500));

          const products = [
            { id: 1, name: 'Laptop Pro', price: '$1,299' },
            { id: 2, name: 'Wireless Mouse', price: '$49' },
            { id: 3, name: 'Mechanical Keyboard', price: '$149' },
            { id: 4, name: '4K Monitor', price: '$599' },
            { id: 5, name: 'USB-C Hub', price: '$79' },
            { id: 6, name: 'Webcam HD', price: '$129' },
          ];

          app.innerHTML = `
            <div class="page">
              <h2>Products</h2>
              <p>Click on any product to see details (demonstrates dynamic routes).</p>

              <div class="product-grid">
                ${products.map(p => `
                  <div class="product-card">
                    <h3><a href="/products/${p.id}">${p.name}</a></h3>
                    <p style="color: #2563eb; font-weight: 600; margin-top: 0.5rem;">${p.price}</p>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        }
      },

      {
        path: '/products/:id',
        component: async () => {
          const app = document.getElementById('app');
          const id = window.location.pathname.split('/')[2];

          app.innerHTML = `
            <div class="page">
              <h2>Product Details</h2>
              <div class="loading" style="margin-top: 2rem;"></div>
            </div>
          `;

          // Simulate API call
          await new Promise(resolve => setTimeout(resolve, 500));

          const products = {
            '1': { name: 'Laptop Pro', price: '$1,299', description: 'High-performance laptop for professionals' },
            '2': { name: 'Wireless Mouse', price: '$49', description: 'Ergonomic wireless mouse with precision tracking' },
            '3': { name: 'Mechanical Keyboard', price: '$149', description: 'RGB mechanical keyboard with cherry switches' },
            '4': { name: '4K Monitor', price: '$599', description: 'Ultra HD 27-inch monitor with HDR' },
            '5': { name: 'USB-C Hub', price: '$79', description: '7-in-1 USB-C hub with HDMI and ethernet' },
            '6': { name: 'Webcam HD', price: '$129', description: '1080p webcam with auto-focus' },
          };

          const product = products[id];

          app.innerHTML = `
            <div class="page">
              <p><a href="/products">← Back to Products</a></p>

              <h2 style="margin-top: 1rem;">${product.name}</h2>
              <p style="color: #2563eb; font-size: 1.5rem; font-weight: 600; margin-top: 0.5rem;">${product.price}</p>
              <p style="margin-top: 1rem;">${product.description}</p>

              <div style="margin-top: 2rem; padding: 1rem; background: #f3f4f6; border-radius: 0.5rem;">
                <h3>Type-Safe Parameters</h3>
                <p style="margin-top: 0.5rem;">Notice how the product ID (<code>${id}</code>) is extracted from the URL?</p>
                <p style="margin-top: 0.5rem;">With TypeScript, this parameter is <strong>type-checked at compile time</strong>.</p>
              </div>
            </div>
          `;
        }
      },

      {
        path: '/contact',
        component: () => {
          document.getElementById('app').innerHTML = `
            <div class="page">
              <h2>Contact</h2>
              <p>Get in touch with us!</p>

              <form style="max-width: 500px; margin-top: 2rem;">
                <div style="margin-bottom: 1rem;">
                  <label style="display: block; margin-bottom: 0.25rem;">Name</label>
                  <input type="text" style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                </div>

                <div style="margin-bottom: 1rem;">
                  <label style="display: block; margin-bottom: 0.25rem;">Email</label>
                  <input type="email" style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                </div>

                <div style="margin-bottom: 1rem;">
                  <label style="display: block; margin-bottom: 0.25rem;">Message</label>
                  <textarea rows="5" style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;"></textarea>
                </div>

                <button type="submit" style="padding: 0.75rem 1.5rem; background: #2563eb; color: white; border: none; border-radius: 0.375rem; cursor: pointer;">
                  Send Message
                </button>
              </form>

              <div style="margin-top: 2rem; padding: 1rem; background: #fef3c7; border-radius: 0.5rem;">
                <p><strong>Note:</strong> This form doesn't actually submit (it's just a demo).</p>
                <p style="margin-top: 0.5rem;">But notice how the form is part of the page content, managed by the router!</p>
              </div>
            </div>
          `;
        }
      }
    ]);

    // Expose for debugging
    window.router = router;
  </script>
</body>
</html>
